import{_ as I}from"./index.bf5f7f0b.js";import{ah as L,o as w,c as N,V as g,P as d,a as x,U as _,O as E,T,ar as U,Q as W}from"./vendor-vue.edbe275b.js";import"./element-icon.ade3aa7e.js";import"./vendor-lib.aab05a6a.js";import"./element-plus.83d58e84.js";const M={name:"",components:{},props:{list:{type:Array}},computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(n){this.currentRow=n,this.dialogVisible=!0},async handleDeleteClick(n){let e={id:n.id};const t=await this.$http.function(e);t.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(t.msg)},async handleStatusChange(n){let e={id:n.id};const t=await this.$http.function(e);t.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(t.msg)},handleUpdateSuccess(){this.$emit("on-success")}},created(){}},H={key:3},Q=["innerHTML"];function Z(n,e,t,o,r,s){const a=L("el-table-column"),l=L("el-tag"),u=L("el-table");return w(),N("div",null,[g(u,{data:t.list,stripe:"",border:""},{default:d(()=>[g(a,{label:"\u64CD\u4F5C\u4EBA","header-align":"center",align:"center",width:"100",prop:"user_name","show-overflow-tooltip":""},{default:d(i=>[x("span",null,_(i.row.user_name||"-"),1)]),_:1}),g(a,{label:"\u64CD\u4F5C\u8868",width:"120","header-align":"center",align:"center",prop:"table","show-overflow-tooltip":""},{default:d(i=>[x("span",null,_(i.row.table||"-"),1)]),_:1}),g(a,{label:"\u64CD\u4F5C\u7C7B\u578B","header-align":"center",align:"center",prop:"type_id",width:"100"},{default:d(i=>[i.row.type_id==2?(w(),E(l,{key:0},{default:d(()=>[T(_(i.row.type_label),1)]),_:2},1024)):i.row.type_id==1?(w(),E(l,{key:1,type:"success"},{default:d(()=>[T(_(i.row.type_label),1)]),_:2},1024)):i.row.type_id==3||i.row.type_id==4?(w(),E(l,{key:2,type:"danger"},{default:d(()=>[T(_(i.row.type_label),1)]),_:2},1024)):(w(),N("span",H,"-"))]),_:1}),g(a,{label:"\u6570\u636E\u53D8\u5316","header-align":"center",align:"left",prop:"type_id"},{default:d(i=>[x("pre",{class:"code",innerHTML:i.row.data},null,8,Q)]),_:1}),g(a,{label:"\u64CD\u4F5C\u65F6\u95F4","header-align":"center",align:"center",prop:"create_time",width:"100"},{default:d(i=>[x("span",null,_(i.row.create_time_label||"-"),1)]),_:1})]),_:1},8,["data"])])}const G=I(M,[["render",Z]]);function v(){}v.prototype={diff:function(e,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=o.callback;typeof o=="function"&&(r=o,o={}),this.options=o;var s=this;function a(f){return r?(setTimeout(function(){r(void 0,f)},0),!0):f}e=this.castInput(e),t=this.castInput(t),e=this.removeEmpty(this.tokenize(e)),t=this.removeEmpty(this.tokenize(t));var l=t.length,u=e.length,i=1,h=l+u;o.maxEditLength&&(h=Math.min(h,o.maxEditLength));var c=[{newPos:-1,components:[]}],y=this.extractCommon(c[0],t,e,0);if(c[0].newPos+1>=l&&y+1>=u)return a([{value:this.join(t),count:t.length}]);function C(){for(var f=-1*i;f<=i;f+=2){var p=void 0,D=c[f-1],z=c[f+1],$=(z?z.newPos:0)-f;D&&(c[f-1]=void 0);var J=D&&D.newPos+1<l,k=z&&0<=$&&$<u;if(!J&&!k){c[f]=void 0;continue}if(!J||k&&D.newPos<z.newPos?(p=Y(z),s.pushComponent(p.components,void 0,!0)):(p=D,p.newPos++,s.pushComponent(p.components,!0,void 0)),$=s.extractCommon(p,t,e,f),p.newPos+1>=l&&$+1>=u)return a(X(s,p.components,t,e,s.useLongestToken));c[f]=p}i++}if(r)(function f(){setTimeout(function(){if(i>h)return r();C()||f()},0)})();else for(;i<=h;){var b=C();if(b)return b}},pushComponent:function(e,t,o){var r=e[e.length-1];r&&r.added===t&&r.removed===o?e[e.length-1]={count:r.count+1,added:t,removed:o}:e.push({count:1,added:t,removed:o})},extractCommon:function(e,t,o,r){for(var s=t.length,a=o.length,l=e.newPos,u=l-r,i=0;l+1<s&&u+1<a&&this.equals(t[l+1],o[u+1]);)l++,u++,i++;return i&&e.components.push({count:i}),e.newPos=l,u},equals:function(e,t){return this.options.comparator?this.options.comparator(e,t):e===t||this.options.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],o=0;o<e.length;o++)e[o]&&t.push(e[o]);return t},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function X(n,e,t,o,r){for(var s=0,a=e.length,l=0,u=0;s<a;s++){var i=e[s];if(i.removed){if(i.value=n.join(o.slice(u,u+i.count)),u+=i.count,s&&e[s-1].added){var c=e[s-1];e[s-1]=e[s],e[s]=c}}else{if(!i.added&&r){var h=t.slice(l,l+i.count);h=h.map(function(C,b){var f=o[u+b];return f.length>C.length?f:C}),i.value=n.join(h)}else i.value=n.join(t.slice(l,l+i.count));l+=i.count,i.added||(u+=i.count)}}var y=e[a-1];return a>1&&typeof y.value=="string"&&(y.added||y.removed)&&n.equals("",y.value)&&(e[a-2].value+=y.value,e.pop()),e}function Y(n){return{newPos:n.newPos,components:n.components.slice(0)}}var q=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,A=/\S/,B=new v;B.equals=function(n,e){return this.options.ignoreCase&&(n=n.toLowerCase(),e=e.toLowerCase()),n===e||this.options.ignoreWhitespace&&!A.test(n)&&!A.test(e)};B.tokenize=function(n){for(var e=n.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),t=0;t<e.length-1;t++)!e[t+1]&&e[t+2]&&q.test(e[t])&&q.test(e[t+2])&&(e[t]+=e[t+2],e.splice(t+1,2),t--);return e};var F=new v;F.tokenize=function(n){var e=[],t=n.split(/(\n|\r\n)/);t[t.length-1]||t.pop();for(var o=0;o<t.length;o++){var r=t[o];o%2&&!this.options.newlineIsToken?e[e.length-1]+=r:(this.options.ignoreWhitespace&&(r=r.trim()),e.push(r))}return e};var S=new v;S.tokenize=function(n){return n.split(/(\S.+?[.!?])(?=\s+|$)/)};var j=new v;j.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)};function O(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?O=function(e){return typeof e}:O=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(n)}var K=Object.prototype.toString,m=new v;m.useLongestToken=!0;m.tokenize=F.tokenize;m.castInput=function(n){var e=this.options,t=e.undefinedReplacement,o=e.stringifyReplacer,r=o===void 0?function(s,a){return typeof a>"u"?t:a}:o;return typeof n=="string"?n:JSON.stringify(R(n,null,null,r),r,"  ")};m.equals=function(n,e){return v.prototype.equals.call(m,n.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function P(n,e,t){return m.diff(n,e,t)}function R(n,e,t,o,r){e=e||[],t=t||[],o&&(n=o(r,n));var s;for(s=0;s<e.length;s+=1)if(e[s]===n)return t[s];var a;if(K.call(n)==="[object Array]"){for(e.push(n),a=new Array(n.length),t.push(a),s=0;s<n.length;s+=1)a[s]=R(n[s],e,t,o,r);return e.pop(),t.pop(),a}if(n&&n.toJSON&&(n=n.toJSON()),O(n)==="object"&&n!==null){e.push(n),a={},t.push(a);var l=[],u;for(u in n)n.hasOwnProperty(u)&&l.push(u);for(l.sort(),s=0;s<l.length;s+=1)u=l[s],a[u]=R(n[u],e,t,o,u);e.pop(),t.pop()}else a=n;return a}var V=new v;V.tokenize=function(n){return n.slice()};V.join=V.removeEmpty=function(n){return n};const ee={name:"log_operation-list",props:{},components:{DataTable:G},data(){return{list:[],total:0,page:1,size:20,keyword:"",loading:!0,dialogVisible:!1}},computed:{},methods:{resetData(){this.page=1,this.getData()},async getData(){this.loading=!0;let n={page:this.page,size:this.size,keyword:this.keyword};try{const e=await this.$http.getOperationLogList(n);e.code==0&&(this.list=e.data.list.map(t=>{try{t.before=JSON.parse(t.before)}catch{}try{t.after=JSON.parse(t.after)}catch{}if(t.type_id==2){let o=P(t.before,t.after);console.log(o);let r=[];o.forEach(s=>{console.log(s),s.added?r.push('<div class="added">'+s.value+"</div>"):s.removed?r.push('<div class="removed">'+s.value+"</div>"):r.push("<div>"+s.value+"</div>")}),t.data=r.join("")}else t.type_id==1?t.data=JSON.stringify(t.after,null,2):(t.type_id==3||t.type_id==4)&&(t.data=JSON.stringify(t.before,null,2));return t}),this.total=e.data.total)}catch(e){console.log(e)}finally{this.loading=!1}},handleAddRow(){this.dialogVisible=!0},handleAddSuccess(){this.resetData()},getObjectString(n){let e=[];for(let[t,o]of Object.entries(n))e.push(`${t}: ${o}`);return e.join(`
`)},handleSearch(){this.resetData()}},created(){this.getData()}},te={class:"app-container"};function ne(n,e,t,o,r,s){const a=L("DataTable"),l=L("el-pagination"),u=U("loading");return w(),N("div",te,[W(g(a,{class:"mt-md",list:r.list,onOnSuccess:s.resetData,onOnEditRow:n.handleEditRow},null,8,["list","onOnSuccess","onOnEditRow"]),[[u,r.loading]]),g(l,{class:"mt-md justify-center",background:"",layout:"total, prev, pager, next",total:r.total,"page-size":r.size,"onUpdate:pageSize":e[0]||(e[0]=i=>r.size=i),"current-page":r.page,"onUpdate:currentPage":e[1]||(e[1]=i=>r.page=i),onCurrentChange:s.getData},null,8,["total","page-size","current-page","onCurrentChange"])])}const le=I(ee,[["render",ne]]);export{le as default};
